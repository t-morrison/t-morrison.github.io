<!DOCTYPE html>
<html>
	<head>
		<title>TRM</title>
		<meta charset="utf-8">
		 
		<script src="https://d3js.org/d3.v4.min.js"></script>
		<link rel="shortcut icon" type="image/x-icon" href="favicon[1].ico">
		<!-- <link rel="stylesheet" type="text/css" href="css/main.css"> -->
		<style>
			#sidebar {
				position: absolute;
				right: 0;
				width: 50%;
				height: 100%;
				z-index: 100;
				<!-- pointer-events: none -->
			}
		</style>
	</head>
	<body>
		<div> Some stuff up here </div>
		
		<div id='list'></div>
		<div id='plot'></div>
		<div id='button'><button type="button" onclick="separate()">Separate</button></div>
		
		<div> Some more stuff down here </div>
		
		<script>
		
			var dat
			var separate
			
			var state = true
			
			
			var h = 400
			var w = 1000
			var xpad = 100  //x in pixels
			var ypad = 20 //y is in pixels
			var barpad = .25
			
			var heightIn
			var widthIn
			
			d3.csv('data.csv', function(data) {
				console.log(data)
				dat = data
				
				
				var xScale = d3.scaleLinear()
							.domain([0,dat.length])
							.range([xpad, w-xpad])
							
				var yScale = d3.scaleLinear()
								.domain([0, dat.length])
								.range([h-ypad, 0])				
				
				var yAxis = d3.axisLeft(yScale)
				var xAxis = d3.axisBottom(xScale)
				
				
				
				
				d3.select('#list').append('ul')
					.selectAll('li')
					.data(dat)
					.enter()
					.append('li')
					.html(function(d){return '<b>'+d.name+'</b>'})
				
				//d3.select('#plot').style('width','100%').append('svg').attr('width', w).attr('height',h)
				//.selectAll('circle')
				//.data(dat)
				//.enter()
				////.append('circle')
				////	.attr('fill','black')				  
				////	.attr('cx', function(d, i){ return xScale(i) })
				////	.attr('cy', function(d, i){return yScale(i) })
				////	.attr('r', 5)
				//.append('text')
				//	.attr('x', function(d, i){ return xScale(i) })
				//	.attr('y', function(d, i){return yScale(i) })
				//	.html(function(d){return d.name})
					
				var width = 450
				var height = 450
				
				var colorScale = d3.scaleOrdinal()
					.domain(d3.map(dat, function(d){return d.section;}).keys())
					.range([ "#F8766D", "#00BA38", "#619CFF"])
				
				var xScale2 = d3.scaleOrdinal()
					.domain(d3.map(dat, function(d){return d.section;}).keys())
					.range([50, 200, 340])
				
				
				var svg = d3.select("#plot")
				  .append("svg")
					.attr("width", 450)
					.attr("height", 450)

				// create dummy data -> just one element per circle
				//var data = [{ "name": "A" }, { "name": "B" }, { "name": "C" }, { "name": "D" }, { "name": "E" }, { "name": "F" }, { "name": "G" }, { "name": "H" }]

				//Initialize the circle: all located at the center of the svg area
				var node = svg.append("g")
				  .selectAll("circle")
				  .data(dat)
				  .enter()
				  .append("circle")
					.attr("r", 29)
					.attr("cx", width / 2)
					.attr("cy", height / 2)
					.style("fill", function(d){ return colorScale(d.section)})
					.style("fill-opacity", 0.8)
					.attr("stroke", "black")
					.style("stroke-width", 4)
					.on('mouseover', function(d){
						
						d3.select(this)
							.attr('stroke', 'blue')
							.append('text')
								//.attr("dx", function(d){return -20})
								.text(function(d){return d.name})
						
					})
					.on('mouseout', function(d){
						
						d3.select(this)
							.attr('stroke', 'black')
						
					})
					
                var simulation = d3.forceSimulation()
					.force("center", d3.forceCenter().x(width / 2).y(height / 2)) // Attraction to the center of the svg area
					.force("charge", d3.forceManyBody().strength(0.5)) // Nodes are attracted one each other of value is > 0
					.force("collide", d3.forceCollide().strength(.01).radius(30).iterations(1)) // Force that avoids circle overlapping

				// Features of the forces applied to the nodes:
				var simulation2 = d3.forceSimulation()
					.force("x", d3.forceX().strength(0.5).x( function(d){ return xScale2(d.section) } ))
					.force("y", d3.forceY().strength(0.1).y( height/2 ))
					//.force("center", d3.forceCenter().x(width / 2).y(height / 2)) // Attraction to the center of the svg area
					//.force("charge", d3.forceManyBody().strength(1)) // Nodes are attracted one each other of value is > 0
					//.force("collide", d3.forceCollide().strength(.1).radius(32).iterations(1)) // Force that avoids circle overlapping
				
				
				
				
				// Apply these forces to the nodes and update their positions.
				// Once the force algorithm is happy with positions ('alpha' value is low enough), simulations will stop.
				simulation
					.nodes(dat)
					.on("tick", function(d){
					  node
						  .attr("cx", function(d){ return d.x; })
						  .attr("cy", function(d){ return d.y; })
					})
				
				separate = function(){
					if(state == true){
						console.log("state==true, returning to separate position")
						
						simulation2
							.nodes(dat)
							.on("tick", function(d){
							  node
								  .attr("cx", function(d){ return d.x; })
								  .attr("cy", function(d){ return d.y; })
							})
						
						state = false
					} else{
						console.log("state==false, returning to original position")
						
						simulation
							.nodes(dat)
							.on("tick", function(d){
							  node
								  .attr("cx", function(d){ return d.x; })
								  .attr("cy", function(d){ return d.y; })
							})
							
							state = true
					}
					
									
				}
			
			})			
		</script>
	</body>
</html>












